d2 <- cars
model <- lm(data=d2, dist~speed) один регрессор спид
model
увидим бета1 и бета2
beta_hat <- coef(model) koeff
eps_hat <- residuals(model) jstatki
y <- d2$dist
y_hat <- fitted(model)
RSS <- deviance(model)
TSS <- sum( (y-mean(y))^2 )
ESS <- TSS - RSS
R2 <- ESS/TSS
or
R2 <- cor(y, y_hat)^2
X <- model.matrix(model)
nd <- data.frame(speed=c(40,60)) Новый набор
predict(model, nd) прогноз по модели нового набора данных


t <- swiss
model2 <- lm(data=t, Fertility~Agriculture+Education, Catholic)
coef(model2)
fitted(model2) спрогнозированные переменные

report <- summary(model2)

nd2 <- data.frame(Agriculture=0.5, Catholic = 0.5, Education = 20)

predict(model2, df2)

при проверке что все регрессоры незначимы
qf
df1 = k-1
df2 = n-k
если 2 степени свободы в df1 то только одно Ф критическое
если Ф наблюдаемое за пределами критического, то гипотеза что все регрессоры незначимы, отвергается

чем больше R2, тем лучше модель. макс=1

В моделях со свободным членом 
R2 = ESS/TSS
R2 = 1 - RSS/TSS
TSS — общий разброс y
ESS — объясненный регрессорами разброс
R2 — доля объясненного разброса в общем разбросе
R2 = cor(y, y?)2

TSS = RSS + ESS
RSS = TSS - ESS
ESS = TSS - RSS

Сумма квадратов остатков. чем меньше, тем лучше модель. у больше коррелирует с регрессорами
RSS
Общая сумма квадратов
TSS
Объясненная сумма квадратов
ESS


vcov(model) вариационная/ковариационная матрица. по диагонали вариация (дисперсия)
например
показывает ковариацию 2 коэф(1 столб) с третьим (третья строка)
дисп по диагонали
3 строка и 2 столб показывает дисперсию 2-го коэф


сигма = Residual standard error в саммари
сигма в квадрате используется

гипотеза что БетаА=0, т.е. не зависит Игрек от БетаА
confint(modelA) доверительный интервал
если 0 входит в довер интервал, то не отвергается гипотеза

если t value (из саммари) входит в довер интервалы(для Т распр),
то гипотеза не отвергается

если p-value (в саммари Pr(>|t|) ) больше альфа=5%
то гипотеза не отвергается

примерный дов интервал
коэфф +- 2* станд ошибка

станд ошибка равно корню из дисперсии
больше дисперсия, больше дов интервал

для Т распр
qt(0.975, df=44) верх довер интервал
qt(0.275, df=44) нижн довер интервал

рамки 95%

для Хи2 распределения
qchisq(0.975, df=44)
qchisq(0.275, df=44)

БСХС — Большой Список Хороших Свойств
ei - эпсилан, ошибка



summary(model)
Estimate - коэффициенты. свободный член и остальные
Std Error - стандартн ошибки (корни из диаг матрицы)
t value проверка гипотез=0 Т-статистикой (1 столб / 2 столб)
нужно сравнить с критическим значением (обычно это(-2, +2)) 
Pr это п значение для коэффициента
*** обозначается значимость коэффициента



Базовые:
верны даже на малых выборках без предположения о нормальности ei

Асимптотические:
верны на больших выборках даже без предположения о нормальности ei

При нормальности:
верны при нормальности ei даже на малых выборках




Проверка гипотезы о незначимости регрессии
F = ESS/(k-1) / RSS/(n-k) = F степ1=k-1, степ2=n-k
n - кол-во наблюдений
k - кол-во оцениваемых бет


простые показатели качества
R2_adj чем выше, тем лучше
Плохо предсказывает - RSS большой
Сложная - много коэффициентов, т.е. большое k

чем штрафные критерии меньше, тем лучше
Акаике AIC = n ln(RSS/n) + 2k
Шварца BIC = n ln(RSS/n) + ln(n)k




мультиколлинеарность - зависимость регрессоров между собой
проверка
VIFj > 10, коэффициент вздутия дисперсии (Variance Inflation Factor) 1/1-R2 квадрат
sCorr(x, z) > 0.9 выборочные корреляции между регрессорами

следствие мультикол-ти: коэф значим, широкий дов интервал

Метод главных компонент
нормировать переменные = ( х - х(средн) ) / (станд ошибку)




условная гетероскедастичность будет наблюдаться в выборках с разными размерами-страны, компании, домохозяйства. все будут разного размера
нужно использовать НС станд ошибки

на графике условная гетероскедастичность = разный разброс данных при разных значениях

дов интервал = оценка-1,96 ст ошибки _____ оценка+1,96 ст оштбки


автокоррелляция
зависимость между близкими наблюдениями например в одном периоде или в одном районе
можно обнаружить если графически построить остатки (ошибки) t-1 и t
тест DW Дарбина-Уотсона
alpa=5%
если р>5% нет автокоррелляции
p<5% есть автокоррелляция
Тест Бройша-Годфри




Метод макс правдоподобия
метод при котором максимально возможны наблюдаемые переменные
логит и пробит модели для зависимой переменно принимающей зн-ния 1 или 0














